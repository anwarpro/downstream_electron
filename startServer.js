/*! For license information please see startServer.js.LICENSE.txt */
!function(Q,U){if("object"==typeof exports&&"object"==typeof module)module.exports=U(require("cors"),require("express"));else if("function"==typeof define&&define.amd)define(["cors","express"],U);else{var F="object"==typeof exports?U(require("cors"),require("express")):U(Q.cors,Q.express);for(var B in F)("object"==typeof exports?exports:Q)[B]=F[B]}}(global,((__WEBPACK_EXTERNAL_MODULE__1761__,__WEBPACK_EXTERNAL_MODULE__2806__)=>(()=>{var __webpack_modules__={4657:(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";eval("\n\nvar fs = __webpack_require__(7147);\nfunction exists(fileUrl, callback) {\n  fs.stat(fileUrl, function (error, stat) {\n    if (error) {\n      callback(false);\n    } else {\n      callback(true, stat.size);\n    }\n  });\n}\nvar _promiseCounter = 0;\nvar _promisesObj = {};\nfunction _generateRequestId() {\n  var ts = new Date().getTime();\n  var requestId;\n  _promiseCounter++;\n  requestId = _promiseCounter + '-' + ts;\n  return requestId;\n}\nfunction processCmd(cmd, args) {\n  var requestId = _generateRequestId();\n  var promise = new Promise(function (resolve, reject) {\n    _promisesObj[requestId] = {\n      resolve: resolve,\n      reject: reject\n    };\n  });\n  var request = {};\n  request.requestId = requestId;\n  request.cmd = cmd;\n  request.args = args;\n  process.send(request);\n  return promise;\n}\nfunction processMessage(data) {\n  var requestId = data.requestId;\n  var error = data.error;\n  var result = data.result;\n  var promiseObj = _promisesObj[requestId + ''];\n  function resolve(result) {\n    promiseObj.resolve(result);\n  }\n  if (promiseObj) {\n    if (data.status === 'OK') {\n      resolve(result);\n    } else {\n      promiseObj.reject(error);\n    }\n    delete _promisesObj[requestId];\n  }\n}\n\n/**\n *\n * @private\n * @returns {void}\n */\nfunction _attachEvents() {\n  process.on('message', processMessage);\n}\n\n/**\n* ContentRoute\n* @param {object} app - express server instance\n* @constructor\n*/\n\nfunction ContentRoute(app, routeName) {\n  var manifestInfo = {};\n  _attachEvents();\n\n  /*------------------------------------------------------------------------------------------*/\n\n  // ROUTER MANAGEMENT\n\n  /*------------------------------------------------------------------------------------------*/\n\n  /**\n   * Handles get movies/manifestId\n   */\n  app.get('/' + routeName + '/:id/*', function (req, res) {\n    var manifestId = req.params['id'];\n\n    // send back file data function\n    var sendFile = function sendFile(file) {\n      var options = {\n        dotfiles: 'deny'\n      };\n      res.sendFile(file, options, function (err) {\n        if (err && err.status) {\n          // error to open file => remove saved info (maybe moved)\n          delete manifestInfo[manifestId];\n          res.status(err.status).end();\n        }\n      });\n    };\n    var seekIfNeeded = function seekIfNeeded(folder) {\n      var file = folder + '/' + manifestId + '/' + req.params[0];\n      exists(file, function (exists) {\n        if (exists) {\n          // fragment exists on disk, let's check if it is not being downloaded\n          processCmd('is_downloading', {\n            manifest: manifestId,\n            file: file\n          }).then(function () {\n            sendFile(file);\n          })[\"catch\"](function () {\n            return res.status(404).end();\n          });\n        } else {\n          // fragment doesn't on disk, ask to download it\n          processCmd('perform_seek', {\n            manifest: manifestId,\n            file: file\n          }).then(function () {\n            sendFile(file);\n          })[\"catch\"](function () {\n            return res.status(404).end();\n          });\n        }\n      });\n    };\n    var getFile = function getFile(info) {\n      if (info && info.status === 'FINISHED') {\n        // if file has status finished, no need to check if fragment is being downloaded\n        var file = info.folder + '/' + manifestId + '/' + req.params[0];\n        exists(file, function (exists) {\n          if (exists) {\n            // fragment exists => send data\n            sendFile(file);\n          } else {\n            // fragment doesn't exists => 404 and remove cached data\n            delete manifestInfo[manifestId];\n            return res.status(404).end();\n          }\n        });\n      } else {\n        // file is not finished, let's perform seek if needed\n        seekIfNeeded(info.folder);\n      }\n    };\n\n    // check if info have been already saved for the manifest\n    if (manifestInfo[manifestId]) {\n      getFile(manifestInfo[manifestId]);\n    } else {\n      // no info for manifest id, asks main process to get manifest info\n      processCmd('get_info', {\n        manifest: manifestId\n      }).then(function (result) {\n        manifestInfo[manifestId] = result;\n        getFile(manifestInfo[manifestId]);\n      })[\"catch\"](function () {\n        delete manifestInfo[manifestId];\n        return res.status(404).send('Cannot find manifest');\n      });\n    }\n  });\n}\nmodule.exports = ContentRoute;//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QyxDQUFDLE1BQU07TUFDTDtNQUNBeEIsVUFBVSxDQUFDLFVBQVUsRUFBRTtRQUFDa0MsUUFBUSxFQUFFVjtNQUFVLENBQUMsQ0FBQyxDQUMzQ1csSUFBSSxDQUFDLFVBQUN2QixNQUFNLEVBQUs7UUFDbEJRLFlBQVksQ0FBQ0ksVUFBVSxDQUFDLEdBQUdaLE1BQU07UUFDakN3QixPQUFPLENBQUVoQixZQUFZLENBQUNJLFVBQVUsQ0FBQyxDQUFDO01BQ3BDLENBQUMsQ0FBQyxTQUNNLENBQUMsWUFBWTtRQUNuQixPQUFRSixZQUFZLENBQUNJLFVBQVUsQ0FBQztRQUNoQyxPQUFPRCxHQUFHLENBQUNULE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQ0wsSUFBSSxDQUFDLHNCQUFzQixDQUFDO01BQ3JELENBQUMsQ0FBQztJQUNKO0VBQ0YsQ0FBQyxDQUFDO0FBQ0o7QUFFQTZCLE1BQU0sQ0FBQ0MsT0FBTyxHQUFHdEIsWUFBWSIsInNvdXJjZXMiOlsid2VicGFjazovL2Rvd25zdHJlYW0tZWxlY3Ryb24vLi9hcGkvc2VydmVyL2NvbnRlbnRSb3V0ZS5qcz84NjY4Il0sInNvdXJjZXNDb250ZW50IjpbIlwidXNlIHN0cmljdFwiO1xuXG5jb25zdCBmcyA9IHJlcXVpcmUoXCJmc1wiKTtcblxuZnVuY3Rpb24gZXhpc3RzIChmaWxlVXJsLCBjYWxsYmFjaykge1xuICBmcy5zdGF0KGZpbGVVcmwsIGZ1bmN0aW9uIChlcnJvciwgc3RhdCkge1xuICAgIGlmIChlcnJvcikge1xuICAgICAgY2FsbGJhY2soZmFsc2UpXG4gICAgfSBlbHNlIHtcbiAgICAgIGNhbGxiYWNrKHRydWUsIHN0YXQuc2l6ZSk7XG4gICAgfVxuICB9KTtcbn1cblxubGV0IF9wcm9taXNlQ291bnRlciA9IDA7XG5sZXQgX3Byb21pc2VzT2JqID0ge307XG5cbmZ1bmN0aW9uIF9nZW5lcmF0ZVJlcXVlc3RJZCAoKSB7XG4gIGxldCB0cyA9IG5ldyBEYXRlKCkuZ2V0VGltZSgpO1xuICBsZXQgcmVxdWVzdElkO1xuICBfcHJvbWlzZUNvdW50ZXIrKztcbiAgcmVxdWVzdElkID0gX3Byb21pc2VDb3VudGVyICsgJy0nICsgdHM7XG4gIHJldHVybiByZXF1ZXN0SWQ7XG59XG5cbmZ1bmN0aW9uIHByb2Nlc3NDbWQgKGNtZCwgYXJncykge1xuICBjb25zdCByZXF1ZXN0SWQgPSBfZ2VuZXJhdGVSZXF1ZXN0SWQoKTtcbiAgY29uc3QgcHJvbWlzZSA9IG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICBfcHJvbWlzZXNPYmpbcmVxdWVzdElkXSA9IHtcbiAgICAgIHJlc29sdmU6IHJlc29sdmUsXG4gICAgICByZWplY3Q6IHJlamVjdFxuICAgIH07XG4gIH0pO1xuICBsZXQgcmVxdWVzdCA9IHt9O1xuICByZXF1ZXN0LnJlcXVlc3RJZCA9IHJlcXVlc3RJZDtcbiAgcmVxdWVzdC5jbWQgPSBjbWQ7XG4gIHJlcXVlc3QuYXJncyA9IGFyZ3M7XG4gIHByb2Nlc3Muc2VuZChyZXF1ZXN0KTtcbiAgcmV0dXJuIHByb21pc2U7XG59XG5cbmZ1bmN0aW9uIHByb2Nlc3NNZXNzYWdlIChkYXRhKSB7XG4gIGNvbnN0IHJlcXVlc3RJZCA9IGRhdGEucmVxdWVzdElkO1xuICBjb25zdCBlcnJvciA9IGRhdGEuZXJyb3I7XG4gIGNvbnN0IHJlc3VsdCA9IGRhdGEucmVzdWx0O1xuICBjb25zdCBwcm9taXNlT2JqID0gX3Byb21pc2VzT2JqW3JlcXVlc3RJZCArICcnXTtcblxuICBmdW5jdGlvbiByZXNvbHZlIChyZXN1bHQpIHtcbiAgICBwcm9taXNlT2JqLnJlc29sdmUocmVzdWx0KTtcbiAgfVxuXG4gIGlmIChwcm9taXNlT2JqKSB7XG4gICAgaWYgKGRhdGEuc3RhdHVzID09PSAnT0snKSB7XG4gICAgICByZXNvbHZlKHJlc3VsdCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHByb21pc2VPYmoucmVqZWN0KGVycm9yKTtcbiAgICB9XG4gICAgZGVsZXRlKF9wcm9taXNlc09ialtyZXF1ZXN0SWRdKTtcbiAgfVxufVxuXG4vKipcbiAqXG4gKiBAcHJpdmF0ZVxuICogQHJldHVybnMge3ZvaWR9XG4gKi9cbmZ1bmN0aW9uIF9hdHRhY2hFdmVudHMgKCkge1xuICBwcm9jZXNzLm9uKCdtZXNzYWdlJywgcHJvY2Vzc01lc3NhZ2UpO1xufVxuXG4vKipcbiogQ29udGVudFJvdXRlXG4qIEBwYXJhbSB7b2JqZWN0fSBhcHAgLSBleHByZXNzIHNlcnZlciBpbnN0YW5jZVxuKiBAY29uc3RydWN0b3JcbiovXG5cbmZ1bmN0aW9uIENvbnRlbnRSb3V0ZSAoYXBwLCByb3V0ZU5hbWUpIHtcblxuICBsZXQgbWFuaWZlc3RJbmZvID0ge307XG5cbiAgX2F0dGFjaEV2ZW50cygpO1xuXG4gIC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuICAvLyBST1VURVIgTUFOQUdFTUVOVFxuXG4gIC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuICAvKipcbiAgICogSGFuZGxlcyBnZXQgbW92aWVzL21hbmlmZXN0SWRcbiAgICovXG4gIGFwcC5nZXQoJy8nICsgcm91dGVOYW1lICsgJy86aWQvKicsIGZ1bmN0aW9uIChyZXEsIHJlcykge1xuXG4gICAgbGV0IG1hbmlmZXN0SWQgPSByZXEucGFyYW1zWydpZCddO1xuXG4gICAgLy8gc2VuZCBiYWNrIGZpbGUgZGF0YSBmdW5jdGlvblxuICAgIGxldCBzZW5kRmlsZSA9IGZ1bmN0aW9uIChmaWxlKSB7XG4gICAgICB2YXIgb3B0aW9ucyA9IHtcbiAgICAgICAgZG90ZmlsZXM6ICdkZW55J1xuICAgICAgfVxuICAgICAgcmVzLnNlbmRGaWxlKGZpbGUsIG9wdGlvbnMsIGZ1bmN0aW9uIChlcnIpIHtcbiAgICAgICAgaWYgKGVyciAmJiBlcnIuc3RhdHVzKSB7XG4gICAgICAgICAgLy8gZXJyb3IgdG8gb3BlbiBmaWxlID0+IHJlbW92ZSBzYXZlZCBpbmZvIChtYXliZSBtb3ZlZClcbiAgICAgICAgICBkZWxldGUgbWFuaWZlc3RJbmZvW21hbmlmZXN0SWRdO1xuICAgICAgICAgIHJlcy5zdGF0dXMoZXJyLnN0YXR1cykuZW5kKCk7XG4gICAgICAgIH1cbiAgICAgIH0pXG4gICAgfVxuXG4gICAgbGV0IHNlZWtJZk5lZWRlZCAgPSBmdW5jdGlvbiAoZm9sZGVyKSB7XG4gICAgICBsZXQgZmlsZSA9IGZvbGRlciArICcvJyArIG1hbmlmZXN0SWQgKyAnLycgKyByZXEucGFyYW1zWzBdO1xuICAgICAgZXhpc3RzKGZpbGUsIChleGlzdHMpID0+IHtcbiAgICAgICAgaWYgKGV4aXN0cykge1xuICAgICAgICAgIC8vIGZyYWdtZW50IGV4aXN0cyBvbiBkaXNrLCBsZXQncyBjaGVjayBpZiBpdCBpcyBub3QgYmVpbmcgZG93bmxvYWRlZFxuICAgICAgICAgIHByb2Nlc3NDbWQoJ2lzX2Rvd25sb2FkaW5nJywge21hbmlmZXN0OiBtYW5pZmVzdElkLCBmaWxlOiBmaWxlfSlcbiAgICAgICAgICAgIC50aGVuKCgpID0+IHtcbiAgICAgICAgICAgIHNlbmRGaWxlKGZpbGUpXG4gICAgICAgICAgfSlcbiAgICAgICAgICAgIC5jYXRjaChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDQpLmVuZCgpO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIC8vIGZyYWdtZW50IGRvZXNuJ3Qgb24gZGlzaywgYXNrIHRvIGRvd25sb2FkIGl0XG4gICAgICAgICAgcHJvY2Vzc0NtZCgncGVyZm9ybV9zZWVrJywge21hbmlmZXN0OiBtYW5pZmVzdElkLCBmaWxlOiBmaWxlfSlcbiAgICAgICAgICAgIC50aGVuKCgpID0+IHtcbiAgICAgICAgICAgIHNlbmRGaWxlKGZpbGUpXG4gICAgICAgICAgfSlcbiAgICAgICAgICAgIC5jYXRjaChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDQpLmVuZCgpO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9KVxuICAgIH1cblxuICAgIGxldCBnZXRGaWxlID0gZnVuY3Rpb24gKGluZm8pIHtcbiAgICAgIGlmIChpbmZvICYmIGluZm8uc3RhdHVzID09PSAnRklOSVNIRUQnKSB7XG4gICAgICAgIC8vIGlmIGZpbGUgaGFzIHN0YXR1cyBmaW5pc2hlZCwgbm8gbmVlZCB0byBjaGVjayBpZiBmcmFnbWVudCBpcyBiZWluZyBkb3dubG9hZGVkXG4gICAgICAgIGxldCBmaWxlID0gaW5mby5mb2xkZXIgKyAnLycgKyBtYW5pZmVzdElkICsgJy8nICsgcmVxLnBhcmFtc1swXTtcbiAgICAgICAgZXhpc3RzKGZpbGUsIChleGlzdHMpID0+IHtcbiAgICAgICAgICBpZiAoZXhpc3RzKSB7XG4gICAgICAgICAgICAvLyBmcmFnbWVudCBleGlzdHMgPT4gc2VuZCBkYXRhXG4gICAgICAgICAgICBzZW5kRmlsZShmaWxlKVxuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAvLyBmcmFnbWVudCBkb2Vzbid0IGV4aXN0cyA9PiA0MDQgYW5kIHJlbW92ZSBjYWNoZWQgZGF0YVxuICAgICAgICAgICAgZGVsZXRlICBtYW5pZmVzdEluZm9bbWFuaWZlc3RJZF07XG4gICAgICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDQpLmVuZCgpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICAvLyBmaWxlIGlzIG5vdCBmaW5pc2hlZCwgbGV0J3MgcGVyZm9ybSBzZWVrIGlmIG5lZWRlZFxuICAgICAgICBzZWVrSWZOZWVkZWQoIGluZm8uZm9sZGVyKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBjaGVjayBpZiBpbmZvIGhhdmUgYmVlbiBhbHJlYWR5IHNhdmVkIGZvciB0aGUgbWFuaWZlc3RcbiAgICBpZiAobWFuaWZlc3RJbmZvW21hbmlmZXN0SWRdKSB7XG4gICAgICBnZXRGaWxlKCBtYW5pZmVzdEluZm9bbWFuaWZlc3RJZF0pO1xuICAgIH0gZWxzZSB7XG4gICAgICAvLyBubyBpbmZvIGZvciBtYW5pZmVzdCBpZCwgYXNrcyBtYWluIHByb2Nlc3MgdG8gZ2V0IG1hbmlmZXN0IGluZm9cbiAgICAgIHByb2Nlc3NDbWQoJ2dldF9pbmZvJywge21hbmlmZXN0OiBtYW5pZmVzdElkfSlcbiAgICAgICAgLnRoZW4oKHJlc3VsdCkgPT4ge1xuICAgICAgICBtYW5pZmVzdEluZm9bbWFuaWZlc3RJZF0gPSByZXN1bHQ7XG4gICAgICAgIGdldEZpbGUoIG1hbmlmZXN0SW5mb1ttYW5pZmVzdElkXSk7XG4gICAgICB9KVxuICAgICAgICAuY2F0Y2goZnVuY3Rpb24gKCkge1xuICAgICAgICBkZWxldGUgIG1hbmlmZXN0SW5mb1ttYW5pZmVzdElkXTtcbiAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDA0KS5zZW5kKCdDYW5ub3QgZmluZCBtYW5pZmVzdCcpO1xuICAgICAgfSk7XG4gICAgfVxuICB9KVxufVxuXG5tb2R1bGUuZXhwb3J0cyA9IENvbnRlbnRSb3V0ZTtcbiJdLCJuYW1lcyI6WyJmcyIsInJlcXVpcmUiLCJleGlzdHMiLCJmaWxlVXJsIiwiY2FsbGJhY2siLCJzdGF0IiwiZXJyb3IiLCJzaXplIiwiX3Byb21pc2VDb3VudGVyIiwiX3Byb21pc2VzT2JqIiwiX2dlbmVyYXRlUmVxdWVzdElkIiwidHMiLCJEYXRlIiwiZ2V0VGltZSIsInJlcXVlc3RJZCIsInByb2Nlc3NDbWQiLCJjbWQiLCJhcmdzIiwicHJvbWlzZSIsIlByb21pc2UiLCJyZXNvbHZlIiwicmVqZWN0IiwicmVxdWVzdCIsInByb2Nlc3MiLCJzZW5kIiwicHJvY2Vzc01lc3NhZ2UiLCJkYXRhIiwicmVzdWx0IiwicHJvbWlzZU9iaiIsInN0YXR1cyIsIl9hdHRhY2hFdmVudHMiLCJvbiIsIkNvbnRlbnRSb3V0ZSIsImFwcCIsInJvdXRlTmFtZSIsIm1hbmlmZXN0SW5mbyIsImdldCIsInJlcSIsInJlcyIsIm1hbmlmZXN0SWQiLCJwYXJhbXMiLCJzZW5kRmlsZSIsImZpbGUiLCJvcHRpb25zIiwiZG90ZmlsZXMiLCJlcnIiLCJlbmQiLCJzZWVrSWZOZWVkZWQiLCJmb2xkZXIiLCJtYW5pZmVzdCIsInRoZW4iLCJnZXRGaWxlIiwiaW5mbyIsIm1vZHVsZSIsImV4cG9ydHMiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///4657\n")},5975:(__unused_webpack_module,__unused_webpack_exports,__webpack_require__)=>{eval("var express = __webpack_require__(2806);\nvar cors = __webpack_require__(1761);\n(function () {\n  process.send({\n    cmd: 'log',\n    log: 'Starting HTTP server'\n  });\n  var server = express();\n  server.use(cors());\n\n  // listen for messages\n  process.on('message', function (data) {\n    // handles init message\n    if (data.cmd === 'init') {\n      // add content route\n      __webpack_require__(4657)(server, data.routeName);\n      // start http server\n      server.listen(data.port, function () {\n        // http server is listening => send back listening port\n        process.send({\n          cmd: 'listening_port',\n          port: data.port\n        });\n      });\n    }\n  });\n})();//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNTk3NS5qcyIsIm1hcHBpbmdzIjoiQUFBQSxJQUFNQSxPQUFPLEdBQUdDLG1CQUFPLENBQUMsSUFBUyxDQUFDO0FBQ2xDLElBQU1DLElBQUksR0FBR0QsbUJBQU8sQ0FBQyxJQUFNLENBQUM7QUFFM0IsYUFBWTtFQUVYRSxPQUFPLENBQUNDLElBQUksQ0FBQztJQUFDQyxHQUFHLEVBQUUsS0FBSztJQUNWQyxHQUFHLEVBQUU7RUFBc0IsQ0FBQyxDQUFDO0VBQzNDLElBQUlDLE1BQU0sR0FBR1AsT0FBTyxFQUFFO0VBQ3RCTyxNQUFNLENBQUNDLEdBQUcsQ0FBQ04sSUFBSSxFQUFFLENBQUM7O0VBRWxCO0VBQ0FDLE9BQU8sQ0FBQ00sRUFBRSxDQUFDLFNBQVMsRUFBRSxVQUFVQyxJQUFJLEVBQUU7SUFFcEM7SUFDQSxJQUFJQSxJQUFJLENBQUNMLEdBQUcsS0FBSyxNQUFNLEVBQUU7TUFDdkI7TUFDQUosbUJBQU8sQ0FBQyxJQUFnQixDQUFDLENBQUNNLE1BQU0sRUFBRUcsSUFBSSxDQUFDQyxTQUFTLENBQUM7TUFDakQ7TUFDQUosTUFBTSxDQUFDSyxNQUFNLENBQUNGLElBQUksQ0FBQ0csSUFBSSxFQUFFLFlBQVk7UUFDbkM7UUFDQVYsT0FBTyxDQUFDQyxJQUFJLENBQUM7VUFBQ0MsR0FBRyxFQUFFLGdCQUFnQjtVQUFFUSxJQUFJLEVBQUVILElBQUksQ0FBQ0c7UUFBSSxDQUFDLENBQUM7TUFDeEQsQ0FBQyxDQUFDO0lBQ0o7RUFDRixDQUFDLENBQUM7QUFDSixDQUFDLEdBQUUiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9kb3duc3RyZWFtLWVsZWN0cm9uLy4vYXBpL3NlcnZlci9zdGFydFNlcnZlci5qcz81ZmE2Il0sInNvdXJjZXNDb250ZW50IjpbImNvbnN0IGV4cHJlc3MgPSByZXF1aXJlKCdleHByZXNzJyk7XG5jb25zdCBjb3JzID0gcmVxdWlyZSgnY29ycycpO1xuXG4oZnVuY3Rpb24gKCkge1xuXG4gIHByb2Nlc3Muc2VuZCh7Y21kOiAnbG9nJyxcbiAgICAgICAgICAgICAgICBsb2c6ICdTdGFydGluZyBIVFRQIHNlcnZlcid9KTtcbiAgbGV0IHNlcnZlciA9IGV4cHJlc3MoKTtcbiAgc2VydmVyLnVzZShjb3JzKCkpO1xuXG4gIC8vIGxpc3RlbiBmb3IgbWVzc2FnZXNcbiAgcHJvY2Vzcy5vbignbWVzc2FnZScsIGZ1bmN0aW9uIChkYXRhKSB7XG5cbiAgICAvLyBoYW5kbGVzIGluaXQgbWVzc2FnZVxuICAgIGlmIChkYXRhLmNtZCA9PT0gJ2luaXQnKSB7XG4gICAgICAvLyBhZGQgY29udGVudCByb3V0ZVxuICAgICAgcmVxdWlyZSgnLi9jb250ZW50Um91dGUnKShzZXJ2ZXIsIGRhdGEucm91dGVOYW1lKTtcbiAgICAgIC8vIHN0YXJ0IGh0dHAgc2VydmVyXG4gICAgICBzZXJ2ZXIubGlzdGVuKGRhdGEucG9ydCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAvLyBodHRwIHNlcnZlciBpcyBsaXN0ZW5pbmcgPT4gc2VuZCBiYWNrIGxpc3RlbmluZyBwb3J0XG4gICAgICAgIHByb2Nlc3Muc2VuZCh7Y21kOiAnbGlzdGVuaW5nX3BvcnQnLCBwb3J0OiBkYXRhLnBvcnR9KTtcbiAgICAgIH0pO1xuICAgIH1cbiAgfSk7XG59KCkpO1xuIl0sIm5hbWVzIjpbImV4cHJlc3MiLCJyZXF1aXJlIiwiY29ycyIsInByb2Nlc3MiLCJzZW5kIiwiY21kIiwibG9nIiwic2VydmVyIiwidXNlIiwib24iLCJkYXRhIiwicm91dGVOYW1lIiwibGlzdGVuIiwicG9ydCJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///5975\n")},7147:Q=>{"use strict";Q.exports=require("fs")},1761:Q=>{"use strict";Q.exports=__WEBPACK_EXTERNAL_MODULE__1761__},2806:Q=>{"use strict";Q.exports=__WEBPACK_EXTERNAL_MODULE__2806__}},__webpack_module_cache__={};function __webpack_require__(Q){var U=__webpack_module_cache__[Q];if(void 0!==U)return U.exports;var F=__webpack_module_cache__[Q]={exports:{}};return __webpack_modules__[Q](F,F.exports,__webpack_require__),F.exports}var __webpack_exports__=__webpack_require__(5975);return __webpack_exports__})()));